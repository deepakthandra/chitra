
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Computer Vision Utility library">
      
      
      
      
      <link rel="icon" href="https://ik.imagekit.io/aniket/chitra/favicon-32x32_zIf2gUdAN.png">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.9">
    
    
      
        <title>chitra</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chitra" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://chitra.readthedocs.io/en/latest" title="chitra" class="md-header__button md-logo" aria-label="chitra" data-md-component="logo">
      
  <img src="https://ik.imagekit.io/aniket/chitra/logo_ddSLdaURS.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            chitra
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/aniketmaurya/chitra/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aniketmaurya/chitra
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://chitra.readthedocs.io/en/latest" title="chitra" class="md-nav__button md-logo" aria-label="chitra" data-md-component="logo">
      
  <img src="https://ik.imagekit.io/aniket/chitra/logo_ddSLdaURS.png" alt="logo">

    </a>
    chitra
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/aniketmaurya/chitra/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aniketmaurya/chitra
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        Introduction
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-chitra" class="md-nav__link">
    What is chitra?
  </a>
  
    <nav class="md-nav" aria-label="What is chitra?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#highlights" class="md-nav__link">
    Highlights:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-pip-recommended" class="md-nav__link">
    Using pip (recommended)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-source" class="md-nav__link">
    From source
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-github" class="md-nav__link">
    From GitHub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loading-data-for-image-classification" class="md-nav__link">
    Loading data for image classification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image-datagenerator" class="md-nav__link">
    Image datagenerator
  </a>
  
    <nav class="md-nav" aria-label="Image datagenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-component" class="md-nav__link">
    Updating component
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progressive-resizing" class="md-nav__link">
    Progressive resizing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tfdata-support" class="md-nav__link">
    tf.data support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trainer" class="md-nav__link">
    Trainer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-visualization" class="md-nav__link">
    Model Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-visualization" class="md-nav__link">
    Data Visualization
  </a>
  
    <nav class="md-nav" aria-label="Data Visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#image-annotation" class="md-nav__link">
    Image annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-serving-framework-agnostic" class="md-nav__link">
    Model Serving (Framework Agnostic)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    Utils
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    Contributing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-of-conduct" class="md-nav__link">
    Code Of Conduct
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="source/image/chitra-class.html" class="md-nav__link">
        image
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="source/visualization/metrics.html" class="md-nav__link">
        Visualization
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="source/image/chitra-class.html" class="md-nav__link">
        Play with Images
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="examples/image-classification/image-classification.html" class="md-nav__link">
        Image Classification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="examples/model-server/model-server.html" class="md-nav__link">
        Model Server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="license.html" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-chitra" class="md-nav__link">
    What is chitra?
  </a>
  
    <nav class="md-nav" aria-label="What is chitra?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#highlights" class="md-nav__link">
    Highlights:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
    <nav class="md-nav" aria-label="Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-pip-recommended" class="md-nav__link">
    Using pip (recommended)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-source" class="md-nav__link">
    From source
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-github" class="md-nav__link">
    From GitHub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loading-data-for-image-classification" class="md-nav__link">
    Loading data for image classification
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image-datagenerator" class="md-nav__link">
    Image datagenerator
  </a>
  
    <nav class="md-nav" aria-label="Image datagenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-component" class="md-nav__link">
    Updating component
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progressive-resizing" class="md-nav__link">
    Progressive resizing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tfdata-support" class="md-nav__link">
    tf.data support
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trainer" class="md-nav__link">
    Trainer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-visualization" class="md-nav__link">
    Model Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-visualization" class="md-nav__link">
    Data Visualization
  </a>
  
    <nav class="md-nav" aria-label="Data Visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#image-annotation" class="md-nav__link">
    Image annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-serving-framework-agnostic" class="md-nav__link">
    Model Serving (Framework Agnostic)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    Utils
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    Contributing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-of-conduct" class="md-nav__link">
    Code Of Conduct
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aniketmaurya/chitra/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chitra">chitra</h1>
<p><a href="https://www.codefactor.io/repository/github/aniketmaurya/chitra"><img alt="CodeFactor" src="https://www.codefactor.io/repository/github/aniketmaurya/chitra/badge" /></a>
<a href="https://sonarcloud.io/dashboard?id=aniketmaurya_chitra"><img alt="Maintainability Rating" src="https://sonarcloud.io/api/project_badges/measure?project=aniketmaurya_chitra&amp;metric=sqale_rating" /></a>
<a href="https://sonarcloud.io/dashboard?id=aniketmaurya_chitra"><img alt="Reliability Rating" src="https://sonarcloud.io/api/project_badges/measure?project=aniketmaurya_chitra&amp;metric=reliability_rating" /></a>
<a href="https://sonarcloud.io/dashboard?id=aniketmaurya_chitra"><img alt="Security Rating" src="https://sonarcloud.io/api/project_badges/measure?project=aniketmaurya_chitra&amp;metric=security_rating" /></a>
<img alt="GitHub issues" src="https://img.shields.io/github/issues/aniketmaurya/chitra?style=flat" />
<a href="https://chitra.readthedocs.io/en/latest/?badge=latest"><img alt="Documentation Status" src="https://readthedocs.org/projects/chitra/badge/?version=latest" /></a>
<a href="https://discord.gg/TdnAfDw3kB"><img alt="Discord" src="https://img.shields.io/discord/848469007443165184?style=flat" /></a></p>
<h2 id="what-is-chitra">What is chitra?</h2>
<p><strong>chitra</strong> (<strong>चित्र</strong>) is a Deep Learning Computer Vision library for easy data loading, data visualization, model building and model
analysis with GradCAM/GradCAM++ and Framework agnostic Model Serving.</p>
<h3 id="highlights">Highlights:</h3>
<ul>
<li>[New] Data Visualization, Bounding Box Visualization 🐶</li>
<li>[New] Framework Agnostic Model Serving ✨🌟</li>
<li>Faster data loading without any boilerplate 🤺</li>
<li>Progressive resizing of images</li>
<li>Rapid experiments with different models using <code>chitra.trainer</code> module 🚀</li>
<li>Model interpretation using GradCAM/GradCAM++ with no extra code 🔥</li>
</ul>
<blockquote>
<p>If you have more use case please <a href="https://github.com/aniketmaurya/chitra/issues/new/choose"><strong>raise an issue/PR</strong></a> with the feature you want.
If you want to contribute, feel free to raise a PR. It doesn't need to be perfect.
We will help you get there.</p>
</blockquote>
<h2 id="installation">Installation</h2>
<p><a href="https://pepy.tech/project/chitra"><img alt="Downloads" src="https://pepy.tech/badge/chitra" /></a>
<a href="https://pepy.tech/project/chitra"><img alt="Downloads" src="https://pepy.tech/badge/chitra/month" /></a>
<img alt="GitHub License" src="https://img.shields.io/github/license/aniketmaurya/chitra?style=flat" /></p>
<h3 id="using-pip-recommended">Using pip (recommended)</h3>
<p><code>pip install -U chitra==0.1.0b3</code></p>
<h3 id="from-source">From source</h3>
<pre><code>git clone https://github.com/aniketmaurya/chitra.git
cd chitra
pip install -e .
</code></pre>
<h3 id="from-github">From GitHub</h3>
<pre><code>pip install git+https://github.com/aniketmaurya/chitra@master
</code></pre>
<h2 id="usage">Usage</h2>
<h3 id="loading-data-for-image-classification">Loading data for image classification</h3>
<p>Chitra <code>dataloader</code> and <code>datagenerator</code> modules for loading data. <code>dataloader</code> is a minimal dataloader that
returns <code>tf.data.Dataset</code> object. <code>datagenerator</code> provides flexibility to users on how they want to load and manipulate
the data.</p>
<pre><code class="language-python">import numpy as np
import chitra
from chitra.dataloader import Clf, show_batch
import matplotlib.pyplot as plt


clf_dl = Clf()
data = clf_dl.from_folder(cat_dog_path, target_shape=(224, 224))
clf_dl.show_batch(8, figsize=(8, 8))
</code></pre>
<p><img alt="Show Batch" src="https://raw.githubusercontent.com/aniketmaurya/chitra/master/docs/assets/images/output_3_1.png" /></p>
<h2 id="image-datagenerator">Image datagenerator</h2>
<p>Dataset class provides the flexibility to load image dataset by updating components of the class.</p>
<p>Components of Dataset class are:</p>
<ul>
<li>image file generator</li>
<li>resizer</li>
<li>label generator</li>
<li>image loader</li>
</ul>
<p>These components can be updated with custom function by the user according to their dataset structure. For example the
Tiny Imagenet dataset is organized as-</p>
<pre><code>train_folder/
.....folder1/
    .....file.txt
    .....folder2/
           .....image1.jpg
           .....image2.jpg
                     .
                     .
                     .
           ......imageN.jpg
</code></pre>
<p>The inbuilt file generator search for images on the <code>folder1</code>, now we can just update the <code>image file generator</code> and
rest of the functionality will remain same.</p>
<p><strong>Dataset also support progressive resizing of images.</strong></p>
<h3 id="updating-component">Updating component</h3>
<pre><code class="language-python">from chitra.datagenerator import Dataset

ds = Dataset(data_path)
# it will load the folders and NOT images
ds.filenames[:3]
</code></pre>
<details><summary>Output</summary>

    No item present in the image size list

    ['/Users/aniket/Pictures/data/tiny-imagenet-200/train/n02795169/n02795169_boxes.txt',
     '/Users/aniket/Pictures/data/tiny-imagenet-200/train/n02795169/images',
     '/Users/aniket/Pictures/data/tiny-imagenet-200/train/n02769748/images']

</details>

<pre><code class="language-python">def load_files(path):
    return glob(f'{path}/*/images/*')


def get_label(path):
    return path.split('/')[-3]


ds.update_component('get_filenames', load_files)
ds.filenames[:3]
</code></pre>
<details><summary>Output</summary>

    get_filenames updated with <function load_files at 0x7fad6916d0e0>
    No item present in the image size list

    ['/Users/aniket/Pictures/data/tiny-imagenet-200/train/n02795169/images/n02795169_369.JPEG',
     '/Users/aniket/Pictures/data/tiny-imagenet-200/train/n02795169/images/n02795169_386.JPEG',
     '/Users/aniket/Pictures/data/tiny-imagenet-200/train/n02795169/images/n02795169_105.JPEG']

</details>

<h3 id="progressive-resizing">Progressive resizing</h3>
<blockquote>
<p>It is the technique to sequentially resize all the images while training the CNNs on smaller to bigger image sizes. Progressive Resizing is described briefly in his terrific fastai course, “Practical Deep Learning for Coders”. A great way to use this technique is to train a model with smaller image size say 64x64, then use the weights of this model to train another model on images of size 128x128 and so on. Each larger-scale model incorporates the previous smaller-scale model layers and weights in its architecture.
~<a href="https://www.kdnuggets.com/2019/05/boost-your-image-classification-model.html">KDnuggets</a></p>
</blockquote>
<pre><code class="language-python">image_sz_list = [(28, 28), (32, 32), (64, 64)]

ds = Dataset(data_path, image_size=image_sz_list)
ds.update_component('get_filenames', load_files)
ds.update_component('get_label', get_label)

# first call to generator
for img, label in ds.generator():
    print('first call to generator:', img.shape)
    break

# seconds call to generator
for img, label in ds.generator():
    print('seconds call to generator:', img.shape)
    break

# third call to generator
for img, label in ds.generator():
    print('third call to generator:', img.shape)
    break
</code></pre>
<details><summary>Output</summary>

    get_filenames updated with <function load_files at 0x7fad6916d0e0>
    get_label updated with <function get_label at 0x7fad6916d8c0>

    first call to generator: (28, 28, 3)
    seconds call to generator: (32, 32, 3)
    third call to generator: (64, 64, 3)

</details>

<h3 id="tfdata-support">tf.data support</h3>
<p>Creating a <code>tf.data</code> dataloader was never as easy as this one liner. It converts the Python generator
into <code>tf.data.Dataset</code> for a faster data loading, prefetching, caching and everything provided by tf.data.</p>
<pre><code class="language-python">image_sz_list = [(28, 28), (32, 32), (64, 64)]

ds = Dataset(data_path, image_size=image_sz_list)
ds.update_component('get_filenames', load_files)
ds.update_component('get_label', get_label)

dl = ds.get_tf_dataset()

for e in dl.take(1):
    print(e[0].shape)

for e in dl.take(1):
    print(e[0].shape)

for e in dl.take(1):
    print(e[0].shape)
</code></pre>
<details><summary>Output</summary>

    get_filenames updated with <function load_files at 0x7fad6916d0e0>
    get_label updated with <detn get_label at 0x7fad6916d8c0>
    (28, 28, 3)
    (32, 32, 3)
    (64, 64, 3)

</details>

<h2 id="trainer">Trainer</h2>
<p>The Trainer class inherits from <code>tf.keras.Model</code>, it contains everything that is required for training. It exposes
trainer.cyclic_fit method which trains the model using Cyclic Learning rate discovered
by <a href="https://arxiv.org/abs/1506.01186">Leslie Smith</a>.</p>
<pre><code class="language-python">from chitra.trainer import Trainer, create_cnn
from chitra.datagenerator import Dataset


ds = Dataset(cat_dog_path, image_size=(224, 224))
model = create_cnn('mobilenetv2', num_classes=2, name='Cat_Dog_Model')
trainer = Trainer(ds, model)
# trainer.summary()
</code></pre>
<pre><code class="language-python">trainer.compile2(batch_size=8,
    optimizer=tf.keras.optimizers.SGD(1e-3, momentum=0.9, nesterov=True),
    lr_range=(1e-6, 1e-3),
    loss='binary_crossentropy',
    metrics=['binary_accuracy'])

trainer.cyclic_fit(epochs=5,
    batch_size=8,
    lr_range=(0.00001, 0.0001),
)
</code></pre>
<details><summary>Training Loop...</summary>
    cyclic learning rate already set!

    Epoch 1/5
    1/1 [==============================] - 0s 14ms/step - loss: 6.4702 - binary_accuracy: 0.2500
    Epoch 2/5
    Returning the last set size which is: (224, 224)
    1/1 [==============================] - 0s 965us/step - loss: 5.9033 - binary_accuracy: 0.5000
    Epoch 3/5
    Returning the last set size which is: (224, 224)
    1/1 [==============================] - 0s 977us/step - loss: 5.9233 - binary_accuracy: 0.5000
    Epoch 4/5
    Returning the last set size which is: (224, 224)
    1/1 [==============================] - 0s 979us/step - loss: 2.1408 - binary_accuracy: 0.7500
    Epoch 5/5
    Returning the last set size which is: (224, 224)
    1/1 [==============================] - 0s 982us/step - loss: 1.9062 - binary_accuracy: 0.8750

    <tensorflow.python.keras.callbacks.History at 0x7f8b1c3f2410>

</details>

<h2 id="model-visualization">Model Visualization</h2>
<p>It is important to understand what is going inside the model. Techniques like GradCam and Saliency Maps can visualize
what the Network is learning. <code>trainer</code> module has InterpretModel class which creates GradCam and GradCam++
visualization with almost no additional code.</p>
<pre><code class="language-python">from chitra.trainer import InterpretModel

trainer = Trainer(ds, create_cnn('mobilenetv2', num_classes=1000, keras_applications=False))
model_interpret = InterpretModel(True, trainer)

image = ds[1][0].numpy().astype('uint8')
image = Image.fromarray(image)
model_interpret(image)
print(IMAGENET_LABELS[285])
</code></pre>
<pre><code>Returning the last set size which is: (224, 224)
index: 282
Egyptian Mau
</code></pre>
<p><img alt="png" src="https://raw.githubusercontent.com/aniketmaurya/chitra/master/docs/assets/images/output_22_1.png" /></p>
<h2 id="data-visualization">Data Visualization</h2>
<h3 id="image-annotation">Image annotation</h3>
<p>Bounding Box creation is based on top of <code>imgaug</code> library.</p>
<pre><code class="language-python">from chitra.image import Chitra


bbox = [70, 25, 190, 210]
label = 'Dog'

image = Chitra(image_path, bboxes=bbox, labels=label)
plt.imshow(image.draw_boxes())
</code></pre>
<p><img alt="png" src="https://raw.githubusercontent.com/aniketmaurya/chitra/master/docs/assets/images/preview-bounding-box.png" /></p>
<p>See <a href="https://chitra.readthedocs.io/en/latest/examples/chitra-class/chitra-class.html">Play with Images</a> for detailed example!</p>
<h2 id="model-serving-framework-agnostic">Model Serving (Framework Agnostic)</h2>
<p>Chitra can create API for Any Learning Model - ML, DL, Image Classification, NLP, Tensorflow or PyTorch.</p>
<pre><code class="language-python">from chitra.serve import create_api
from chitra.trainer import create_cnn

model = create_cnn('mobilenetv2', num_classes=2)
create_api(model, run=True, api_type='image-classification')
</code></pre>
<details><summary>API Docs Preview</summary>

![Preview Model Server](https://raw.githubusercontent.com/aniketmaurya/chitra/master/docs/examples/model-server/preview.png)

</details>

<p>See <a href="https://chitra.readthedocs.io/en/latest/examples/model-server/model-server.html">Example Section</a> for detailed explanation!</p>
<h2 id="utils">Utils</h2>
<p>Limit GPU memory or enable dynamic GPU memory growth for Tensorflow.</p>
<pre><code class="language-python">from chitra.utils import limit_gpu, gpu_dynamic_mem_growth

# limit the amount of GPU required for your training
limit_gpu(gpu_id=0, memory_limit=1024 * 2)
</code></pre>
<pre><code>No GPU:0 found in your system!
</code></pre>
<pre><code class="language-python">gpu_dynamic_mem_growth()
</code></pre>
<pre><code>No GPU found on the machine!
</code></pre>
<h2 id="contributing">Contributing</h2>
<p>Contributions of any kind are welcome. Please check the <a href="https://github.com/aniketmaurya/chitra/blob/master/CONTRIBUTING.md"><strong>Contributing
Guidelines</strong></a> before contributing.</p>
<h2 id="code-of-conduct">Code Of Conduct</h2>
<p>We pledge to act and interact in ways that contribute to an open, welcoming, diverse, inclusive, and healthy community.</p>
<p>Read full <a href="https://github.com/aniketmaurya/chitra/blob/master/CODE_OF_CONDUCT.md"><strong>Contributor Covenant Code of
Conduct</strong></a></p>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 4, 2021</span>
      
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
      
        
        <a href="source/image/chitra-class.html" class="md-footer__link md-footer__link--next" aria-label="Next: image" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              image
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["search.suggest", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.477d984a.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.82b56eb2.min.js"></script>
      
    
  </body>
</html>